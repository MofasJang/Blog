---
title: 论文笔记-AdaSpeech 2： Adaptive Text to Speech with Untranscribed Data
copyright: true
date: 2021-10-30 10:33:21
tags: 语音合成
categories:
- 语音合成
- 论文阅读
---
## AdaSpeech 2: Adaptive Text to Speech with Untranscribed Data
{% note info %}
论文链接：[AdaSpeech 2: Adaptive Text to Speech with Untranscribed Data](https://arxiv.org/pdf/2104.09715)
源码：[](https://github.com/rishikksh20/AdaSpeech2)
{% endnote %}

### 一. 关注问题

​		由于AdaSpeech在合成语音时仅能适配已转录的语音数据，许多场景需要对未转录（无文本标注）的语音数据进行适配，为了扩大自适应TTS的应用场景，因此开发对未转录语音数据进行自适应的TTS系统。
<!-- more -->

### 二. AdaSpeech

#### 1. 模型结构

![](http://pic.panjiangtao.cn/202111031711_378.png)

![](http://pic.panjiangtao.cn/202111032215_966.png)

​		非自回归模型并行生成序列的所有标记，非线性，与自回归(AR)模型相比，生成速度更快，但代价是准确性较低。（引入隐变量z）

​		以非自回归的FastSpeech2作为模型主体框架，包括一个音素编码器、梅尔频谱解码器和一个给音素隐藏序列（phoneme hidden sequence）提供时长、能量、音高等变化信息的方差适配器。在FastSpeech2基础上，增加了两个模块来实现音色定制：

1. 声学状态建模，捕获适配声音中的丰富声学特征

2. 条件层归一化，用在解码器中降低适配参数量

   ![](http://pic.panjiangtao.cn/202111032114_122.png)

* scale $\gamma$：尺度向量

* bias $\beta$：偏差向量

* mean、var：隐藏序列x的均值和方差

  ![](http://pic.panjiangtao.cn/202111032132_25.png)

W 两个简单线性层，E 说话人嵌入

​		s是说话人ID，c为解码器需要条件归一化的层数。

​		只用到两个简单的线性层，输入是speaker embedding，输出预测γ和β

#### 2. 定制语音过程：预训练、微调、推理

* 在预训练阶段，TTS模型在大规模的多扬声器数据集上培训，这可以确保TTS模型涵盖各种文本和讲台有助于适应的声音。
* 在微调阶段，源TTS模型通过在具有不同声学条件的有限自适应数据上的微调（部分）的微调（一部分）上的新语音。
* 在推理阶段期间，非适配的参数（由所有自定义语音共享的参数）和TTS模型的适配参数（每个自定义语音具有特定的调整参数）用于推理请求。

### 三、AdaSpeech 2

​		在AdaSpeech的基本结构（①音素编码器、梅尔频谱解码器）的基础上，加入②梅尔频谱编码器进行语言重建。适配过程：①源模型的训练，预训练一个多说话人TTS模型 ②限制梅尔编码器的输出序列接近音素编码器的输出序列与L2损失，用L2 loss训练一个梅尔编码器让它的输出空间分布接近音素编码器的输出。③训练完梅尔编码器后，用其对未转录语音数据重建语音，并微调梅尔解码器的模型参数。④使用音素编码器和梅尔解码器构造TTS系统合成语音。



#### 1. 模型结构

![AdaSpeech2结构](http://pic.panjiangtao.cn/202110301030_190.jpg)

 1）音素编码器（由4个前馈转换器构成）、梅尔频谱解码器（由4个前馈转换器构成）构成TTS管道

 2）单独设立的梅尔频谱编码器，由4个前馈转换器构成

#### 2. 适配过程

![适配步骤](http://pic.panjiangtao.cn/202110301031_731.jpg)

1）源模型训练过程

*  音素编码器，将音素序列转换为隐藏序列
*  将隐藏序列根据每个音素的持续时间进行展开，使其匹配梅尔频谱序列长度
*  将展开后的隐藏序列输入到梅尔解码器

2）**梅尔编码器对齐**（本文核心工作，设计一个梅尔频谱编码器在自适应时可以使用无标注的语音数据，并且不影响TTS）

* 将使用源转录的语音数据通过梅尔编码器生成隐藏序列

* 使用长度相同的梅尔编码器生成的隐藏序列，和音素编码器生成的展开隐藏序列，计算L2损失进行训练(有稳定解且只有一个)

  $D_{L2}=\sum_{i=1}^n (y_i-f(x_i))^2$

* 对齐训练时，只训练梅尔编码器的参数，保持TTS管道的参数不变，保证能够可插拔

3）未转录语音自适应

* 未转录数据通过使用梅尔编码器和梅尔解码器进行语音重建，得到预测梅尔频谱，根据该重建的损失来微调模型，使模型加入使用者语音特征
* 在AdaSpeech中，为了既保证自适应质量同时使微调参数尽可能少，只对和条件层归一化（CLN）有关的参数进行优化

4）推理

* 使用原始的未适配音素编码器和部分适配的梅尔解码器形成个性化的 TTS 系统，为每个特定的说话者生成语音

